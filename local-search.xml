<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>CTF-MISC基础知识之图片</title>
    <link href="/2022/04/05/CTF-MISC%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    <url>/2022/04/05/CTF-MISC%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
    
    <content type="html"><![CDATA[<p><strong>MISC作为CTF中比较重要的一类题型，分值占比较大，为了帮助大家更好的学习MISC的做题方法，我总结了常见的图片类型中的几种题型及工具：</strong></p><ul><li><p>图片，音频，视频</p><blockquote><p>首先就是大家常见的图片分析，图片修复，图片修改长宽高，图片拼接，二维码扫描，LSB隐写等等。</p></blockquote><p>遇到图片类型的题，首先最基础的图片分析，将图片丢到winhex或者010editor中分析。分析此图片有无隐写信息或分析是否包含压缩包等。以下是总结的各类型文件的文件头：</p><blockquote><p>PNG (png)，文件头：89504E47<br>GIF (gif)，文件头：47494638<br>TIFF (tif)，文件头：49492A00<br>Windows Bitmap (bmp)，文件头：424DC001<br>CAD (dwg)，文件头：41433130<br>Adobe Photoshop (psd)，文件头：38425053<br>Rich Text Format (rtf)，文件头：7B5C727466<br>XML (xml)，文件头：3C3F786D6C<br>HTML (html)，文件头：68746D6C3E<br>Email [thorough only] (eml)，文件头：44656C69766572792D646174653A<br>Outlook Express (dbx)，文件头：CFAD12FEC5FD746F<br>Outlook (pst)，文件头：2142444E<br>旧版office MS Word&#x2F;Excel (xls.or.doc or.ppt)，文件头：D0CF11E0<br>MS Access (mdb)，文件头：5374616E64617264204A<br>WordPerfect (wpd)，文件头：FF575043<br>Adobe Acrobat (pdf)，文件头：255044462D312E<br>Quicken (qdf)，文件头：AC9EBD8F<br>ZIP Archive (zip)，文件头：504B0304<br>RAR Archive (rar)，文件头：52617221<br>Wave (wav)，文件头：57415645</p><p>JPEG (jpg)，文件头：FFD8FFE1<br>&lt;.img<br>src&#x3D;”data:image…….”<br>alt&#x3D;”Base64 encoded image” &#x2F;&gt; 生成图片（常用于base64隐写图片）</p></blockquote><p>查看图片基本信息，kali下输入:</p><blockquote><p>exiftool 1.jpg</p></blockquote><p>当需要文件分离时，需要在Kali下文件分离</p><p><strong>binwalk</strong>文件分离</p><blockquote><p>binwalk -e +文件名 ||binwalk +文件名</p></blockquote><p><strong>foremost</strong>文件分离</p><blockquote><p>foremost -i +文件名</p></blockquote><p><strong>dd</strong> 文件分离 </p><p>dd命令作用是用指定大小的块拷贝一个文件，并在拷贝的同时进行指定的转换。</p><blockquote><p>dd if&#x3D;原文件名 of&#x3D;(要分解的文件名) skip&#x3D;5016064(十进制值) bs&#x3D;1</p></blockquote></li></ul><p>​     </p><p> 当遇到图片隐写题时，可以使用<strong>Stegsolve</strong>工具（可用于逐帧分析GIF图片，lsb隐写等）</p><p>​      使用方法如下：</p><blockquote><p>File Format:文件格式</p><p>Data Extract:数据提取</p><p>Steregram Solve:立体试图 可以左右控制偏移</p><p>Frame Browser:帧浏览器</p><p>Image Combiner:拼图，图片拼接</p></blockquote><p>  <strong>stegdetect</strong> 查询jpg图片经过哪种隐写 将图片复制到     stegdetect.exe所在目录下右键PowerShell命令</p><blockquote><p>.\stegdetect.exe -tjopi -s 10.0 .\hide.jpg</p></blockquote><p>   检测该图片用的是哪种加密方式.</p><p><strong>F5图片隐写</strong> Kali工具  点开F5-steganography文件夹 在控制端导入 输入java Extract 图片</p><p><strong>图片高宽</strong>的修改</p><p><strong>tweakpng.exe</strong>打开图片提示IDHRcyc错误，表示文件尺寸被修改，且未修改crc值</p><p><strong>outguess</strong>(关键词 猜)  </p><blockquote><p>无加密:outguess -r &#x2F;root&#x2F;angrybird.jpg -t 11.txt<br>     解密 outguess -k “my secret key” -r out.jpg hidden.txt</p></blockquote><p><strong>steghide隐写</strong> (图片或音频) Kali命令</p><blockquote><p>steghide extract -sf 文件(密码一般为空或者文件名)</p></blockquote><p><strong>题目提示NTFS</strong>  是在txt中隐藏了txt文件 cmd 输入</p><blockquote><p>notepad <em>.txt:</em>.txt</p></blockquote><p>IDAT模块很多时 用<strong>tweakpng</strong>修改 Kali中用</p><blockquote><p>pngcheck -vv 查看</p></blockquote><p><strong>JPHS隐写</strong>:(txt藏在JPG里) 打开需要提取隐藏信息的图片h.jpg 点seek输入对应密码（大多为123456）</p><p><strong>zsteg</strong>可以检测PNG和BMP图片里的隐写数据。</p><p>zsteg支持检测：<br>1：LSB steganography in PNG &amp; BMP<br>2：zlib-compressed data<br>3：OpenStego<br>4：Camouflage 1.2.1<br>5：LSB with The Eratosthenes set</p><blockquote><p>zsteg -E “extradata:0” xxxx.png &gt; flag</p></blockquote><p>**MP3stego(**音频隐写)详细看</p><p><a href="https://blog.csdn.net/myloveprogrmming/article/details/52641916">https://blog.csdn.net/myloveprogrmming/article/details/52641916</a></p><p><strong>Audacity</strong> 音频查看工具</p><p>针对音频题目的常用工具，具体使用教程见</p><p><a href="http://www.360doc.com/content/13/0620/17/1437142_294320939.shtml">http://www.360doc.com/content/13/0620/17/1437142_294320939.shtml</a></p><p>时间有限，有空的时候还会继续补充。</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
